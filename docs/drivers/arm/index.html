<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-drivers/arm">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Arm driver | Future Mundane Caravan</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://tlodge.github.io/fmundane-engine/docs/drivers/arm"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Arm driver | Future Mundane Caravan"><meta data-rh="true" name="description" content="The arm driver handles the door opening, the drawer opening and the arm movement for the webcam in the caravan. It communicates with a nodemcu ESP8266 controller (https://www.amazon.co.uk/AZDelivery-NodeMcu-ESP8266-Development-including/dp/B074Q2WM1Y/)"><meta data-rh="true" property="og:description" content="The arm driver handles the door opening, the drawer opening and the arm movement for the webcam in the caravan. It communicates with a nodemcu ESP8266 controller (https://www.amazon.co.uk/AZDelivery-NodeMcu-ESP8266-Development-including/dp/B074Q2WM1Y/)"><link data-rh="true" rel="icon" href="/fmundane-engine/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tlodge.github.io/fmundane-engine/docs/drivers/arm"><link data-rh="true" rel="alternate" href="https://tlodge.github.io/fmundane-engine/docs/drivers/arm" hreflang="en"><link data-rh="true" rel="alternate" href="https://tlodge.github.io/fmundane-engine/docs/drivers/arm" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/fmundane-engine/blog/rss.xml" title="Future Mundane Caravan RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/fmundane-engine/blog/atom.xml" title="Future Mundane Caravan Atom Feed"><link rel="stylesheet" href="/fmundane-engine/assets/css/styles.c8cfa761.css">
<link rel="preload" href="/fmundane-engine/assets/js/runtime~main.87073ab7.js" as="script">
<link rel="preload" href="/fmundane-engine/assets/js/main.403f0574.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/fmundane-engine/"><div class="navbar__logo"><img src="/fmundane-engine/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/fmundane-engine/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">The Future Mundane Caravan</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fmundane-engine/docs/intro">Overview</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fmundane-engine/docs/category/caravan-drivers">Drivers</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fmundane-engine/docs/category/troubleshooting">Troubleshooting</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fmundane-engine/docs/category/twine">Authoring using Twine</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tlodge/fmundane-engine" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fmundane-engine/docs/intro">Caravan Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fmundane-engine/docs/experience">Creating Experiences</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/fmundane-engine/docs/category/caravan-drivers">Caravan Drivers</a><button aria-label="Toggle the collapsible sidebar category &#x27;Caravan Drivers&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/screen">Screen driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/dyson">Dyson driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/fmundane-engine/docs/drivers/arm">Arm driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/smell">Smell driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/windows">Window driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/hue">Hue driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/nanoleaf">Nanoleaf driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/miniscreen">Miniscreen driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/media">Media driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/speech">Speech driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/speechtotext">Speech to text</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/neopixel">Neopixel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fmundane-engine/docs/drivers/receipt">Reciept driver</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fmundane-engine/docs/startup">Caravan startup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fmundane-engine/docs/webapps">Future mundane webapps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fmundane-engine/docs/running">Running code</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fmundane-engine/docs/category/troubleshooting">Troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fmundane-engine/docs/category/twine">Twine</a><button aria-label="Toggle the collapsible sidebar category &#x27;Twine&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fmundane-engine/docs/todo">Future work, fixes and improvements</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/fmundane-engine/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/fmundane-engine/docs/category/caravan-drivers"><span itemprop="name">Caravan Drivers</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Arm driver</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Arm driver</h1><p>The arm driver handles the door opening, the drawer opening and the arm movement for the webcam in the caravan. It communicates with a nodemcu ESP8266 controller (<a href="https://www.amazon.co.uk/AZDelivery-NodeMcu-ESP8266-Development-including/dp/B074Q2WM1Y/" target="_blank" rel="noopener noreferrer">https://www.amazon.co.uk/AZDelivery-NodeMcu-ESP8266-Development-including/dp/B074Q2WM1Y/</a>)</p><p>The controller code can be found in the <a href="https://github.com/tlodge/fmundane-arduino" target="_blank" rel="noopener noreferrer">https://github.com/tlodge/fmundane-arduino</a> repo in the arm directory. The controller handles the door and drawer opening (it does <strong>not</strong> communicate with the arm, which is done directly by the arm driver.</p><p>It listens for (GET) requests to the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/drawer/open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/drawer/close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/door/open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/door/close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/status</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that the controller reads from the rear and front drawer switches and the door switch to determine the current state of the system.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="wiring">Wiring<a class="hash-link" href="#wiring" title="Direct link to heading">​</a></h2><p>Two wires connect the nodeMCU controller to the Arduino GRBL NANO controller (<a href="https://www.amazon.co.uk/dp/B078S8BJ8T" target="_blank" rel="noopener noreferrer">https://www.amazon.co.uk/dp/B078S8BJ8T</a>) on the stepper and servo control board (<a href="https://www.aliexpress.com/item/1005002035301194.html" target="_blank" rel="noopener noreferrer">https://www.aliexpress.com/item/1005002035301194.html</a>). The serial out pin is connected to the serial IN of the GRBL NANO control board. The nodeMCU then just sends serial GRBL commands to control the stepper. The second wire is between the nodeMCU ground and the GRBL NANO ground. The rest of the wires going to the controller are just from the switches.</p><img loading="lazy" src="/img/wiring.jpg" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-node-server-endpoints">The node (server) endpoints<a class="hash-link" href="#the-node-server-endpoints" title="Direct link to heading">​</a></h2><table><thead><tr><th><strong>endpoint</strong></th><th><strong>method</strong></th><th><strong>description</strong></th><th><strong>params</strong></th></tr></thead><tbody><tr><td>/api/arm/expand</td><td>GET</td><td>Run through the full routine to end with the camera extended at the end of the arm (i.e. open door, open drawer, expand arm)</td><td></td></tr><tr><td>/api/arm/collapse</td><td>GET</td><td>Run through the full routine to end with the camera back in the box (collapse arrm, close drawer, close door)</td><td></td></tr><tr><td>/api/arm/scan</td><td>GET</td><td>Once expanded, look left and right as though scanning faces.</td><td></td></tr><tr><td>/api/arm/lights</td><td>GET</td><td>Turn the servo lights a particular colour.</td><td><strong>colour</strong>: an integer from 0-7:0=Off; 1=Red; 2=Green; 3=Blue; 4=Yellow; 5=Cyan; 6=Magenta; 7=White</td></tr><tr><td>/api/arm/flash</td><td>GET</td><td>Flash the servo lights various colours</td><td><ul> <li> <strong>colours</strong> : an array of colours e.g. <!-- -->[1,2]<!-- --> to flash red and green</li><li> <strong>speed</strong> : the time is ms between colour change </li> <li> <strong>repetitions</strong> : the number of repetitions (i.e. how many times the lights flash) </li></ul></td></tr><tr><td>/api/arm/yes</td><td>GET</td><td>Nod the camera as though saying yes</td><td></td></tr><tr><td>/api/arm/no</td><td>GET</td><td>Nod the camera as though saying no</td><td></td></tr><tr><td>/api/arm/home</td><td>GET</td><td>Move the camera into the position it is first in when expanded.</td><td></td></tr><tr><td>/api/arm/point</td><td>GET</td><td>Point at various things in the caravan</td><td><strong>subject</strong>: <ul><li> <strong>dyson</strong>: point at the dyson fan</li> <li> <strong>windows</strong>: point left and right at the windows</li><li><strong>door</strong>: point at the caravan door</li><li> <strong>screen</strong>: point (backwards) at the screen</li><li><strong>down</strong>: look down</li><li> <strong>forward</strong>: reach forward</li><li> <strong>mad</strong>: spin and generally behave erratically</li></ul></td></tr><tr><td>/api/arm/status</td><td>GET</td><td>Return status information on the drawer and the door.</td><td></td></tr><tr><td>/api/arm/toggledoor</td><td>GET</td><td>Open / close the door</td><td></td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/fmundane-engine/docs/drivers/dyson"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Dyson driver</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/fmundane-engine/docs/drivers/smell"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Smell driver</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#wiring" class="table-of-contents__link toc-highlight">Wiring</a></li><li><a href="#the-node-server-endpoints" class="table-of-contents__link toc-highlight">The node (server) endpoints</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Future Mundane. Built with Docusaurus.</div></div></div></footer></div>
<script src="/fmundane-engine/assets/js/runtime~main.87073ab7.js"></script>
<script src="/fmundane-engine/assets/js/main.403f0574.js"></script>
</body>
</html>